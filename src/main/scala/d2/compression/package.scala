package d2

package object compression {

  implicit class ByteToUnsignedByte(byte: Byte) {
    def unsigned: Int = byte & 0xFF
  }

  val charIndex: Array[Int] = Array(
    0x0247, 0x0236, 0x0225, 0x0214, 0x0203, 0x01F2, 0x01E1, 0x01D0,
    0x01BF, 0x01AE, 0x019D, 0x018C, 0x017B, 0x016A, 0x0161, 0x0158,
    0x014F, 0x0146, 0x013D, 0x0134, 0x012B, 0x0122, 0x0119, 0x0110,
    0x0107, 0x00FE, 0x00F5, 0x00EC, 0x00E3, 0x00DA, 0x00D1, 0x00C8,
    0x00BF, 0x00B6, 0x00AD, 0x00A8, 0x00A3, 0x009E, 0x0099, 0x0094,
    0x008F, 0x008A, 0x0085, 0x0080, 0x007B, 0x0076, 0x0071, 0x006C,
    0x0069, 0x0066, 0x0063, 0x0060, 0x005D, 0x005A, 0x0057, 0x0054,
    0x0051, 0x004E, 0x004B, 0x0048, 0x0045, 0x0042, 0x003F, 0x003F,
    0x003C, 0x003C, 0x0039, 0x0039, 0x0036, 0x0036, 0x0033, 0x0033,
    0x0030, 0x0030, 0x002D, 0x002D, 0x002A, 0x002A, 0x0027, 0x0027,
    0x0024, 0x0024, 0x0021, 0x0021, 0x001E, 0x001E, 0x001B, 0x001B,
    0x0018, 0x0018, 0x0015, 0x0015, 0x0012, 0x0012, 0x0012, 0x0012,
    0x000F, 0x000F, 0x000F, 0x000F, 0x000C, 0x000C, 0x000C, 0x000C,
    0x0009, 0x0009, 0x0009, 0x0009, 0x0006, 0x0006, 0x0006, 0x0006,
    0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003,
    0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003, 0x0003,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000
  )

  val charTable: Array[Char] =
    Array(
      0x00.toChar, 0x00.toChar, 0x01.toChar, 0x00.toChar, 0x01.toChar, 0x04.toChar, 0x00.toChar, 0xFF.toChar, 0x06.toChar, 0x00.toChar, 0x14.toChar, 0x06.toChar,
      0x00.toChar, 0x13.toChar, 0x06.toChar, 0x00.toChar, 0x05.toChar, 0x06.toChar, 0x00.toChar, 0x02.toChar, 0x06.toChar, 0x00.toChar, 0x80.toChar, 0x07.toChar,
      0x00.toChar, 0x6D.toChar, 0x07.toChar, 0x00.toChar, 0x69.toChar, 0x07.toChar, 0x00.toChar, 0x68.toChar, 0x07.toChar, 0x00.toChar, 0x67.toChar, 0x07.toChar,
      0x00.toChar, 0x1E.toChar, 0x07.toChar, 0x00.toChar, 0x15.toChar, 0x07.toChar, 0x00.toChar, 0x12.toChar, 0x07.toChar, 0x00.toChar, 0x0D.toChar, 0x07.toChar,
      0x00.toChar, 0x0A.toChar, 0x07.toChar, 0x00.toChar, 0x08.toChar, 0x07.toChar, 0x00.toChar, 0x07.toChar, 0x07.toChar, 0x00.toChar, 0x06.toChar, 0x07.toChar,
      0x00.toChar, 0x04.toChar, 0x07.toChar, 0x00.toChar, 0x03.toChar, 0x07.toChar, 0x00.toChar, 0x6C.toChar, 0x08.toChar, 0x00.toChar, 0x51.toChar, 0x08.toChar,
      0x00.toChar, 0x20.toChar, 0x08.toChar, 0x00.toChar, 0x1F.toChar, 0x08.toChar, 0x00.toChar, 0x1D.toChar, 0x08.toChar, 0x00.toChar, 0x18.toChar, 0x08.toChar,
      0x00.toChar, 0x17.toChar, 0x08.toChar, 0x00.toChar, 0x16.toChar, 0x08.toChar, 0x00.toChar, 0x11.toChar, 0x08.toChar, 0x00.toChar, 0x10.toChar, 0x08.toChar,
      0x00.toChar, 0x0F.toChar, 0x08.toChar, 0x00.toChar, 0x0C.toChar, 0x08.toChar, 0x00.toChar, 0x0B.toChar, 0x08.toChar, 0x00.toChar, 0x09.toChar, 0x08.toChar,
      0x01.toChar, 0x96.toChar, 0x09.toChar, 0x97.toChar, 0x09.toChar, 0x01.toChar, 0x90.toChar, 0x09.toChar, 0x95.toChar, 0x09.toChar, 0x01.toChar, 0x64.toChar,
      0x09.toChar, 0x6B.toChar, 0x09.toChar, 0x01.toChar, 0x62.toChar, 0x09.toChar, 0x63.toChar, 0x09.toChar, 0x01.toChar, 0x56.toChar, 0x09.toChar, 0x58.toChar,
      0x09.toChar, 0x01.toChar, 0x52.toChar, 0x09.toChar, 0x55.toChar, 0x09.toChar, 0x01.toChar, 0x4D.toChar, 0x09.toChar, 0x50.toChar, 0x09.toChar, 0x01.toChar,
      0x45.toChar, 0x09.toChar, 0x4C.toChar, 0x09.toChar, 0x01.toChar, 0x40.toChar, 0x09.toChar, 0x43.toChar, 0x09.toChar, 0x01.toChar, 0x31.toChar, 0x09.toChar,
      0x3B.toChar, 0x09.toChar, 0x01.toChar, 0x28.toChar, 0x09.toChar, 0x30.toChar, 0x09.toChar, 0x01.toChar, 0x1A.toChar, 0x09.toChar, 0x25.toChar, 0x09.toChar,
      0x01.toChar, 0x0E.toChar, 0x09.toChar, 0x19.toChar, 0x09.toChar, 0x02.toChar, 0xE2.toChar, 0x0A.toChar, 0xE8.toChar, 0x0A.toChar, 0xF0.toChar, 0x0A.toChar,
      0xF8.toChar, 0x0A.toChar, 0x02.toChar, 0xC0.toChar, 0x0A.toChar, 0xC2.toChar, 0x0A.toChar, 0xCE.toChar, 0x0A.toChar, 0xE0.toChar, 0x0A.toChar, 0x02.toChar,
      0xA0.toChar, 0x0A.toChar, 0xA2.toChar, 0x0A.toChar, 0xB0.toChar, 0x0A.toChar, 0xB8.toChar, 0x0A.toChar, 0x02.toChar, 0x8A.toChar, 0x0A.toChar, 0x8F.toChar,
      0x0A.toChar, 0x93.toChar, 0x0A.toChar, 0x98.toChar, 0x0A.toChar, 0x02.toChar, 0x81.toChar, 0x0A.toChar, 0x82.toChar, 0x0A.toChar, 0x83.toChar, 0x0A.toChar,
      0x89.toChar, 0x0A.toChar, 0x02.toChar, 0x7C.toChar, 0x0A.toChar, 0x7D.toChar, 0x0A.toChar, 0x7E.toChar, 0x0A.toChar, 0x7F.toChar, 0x0A.toChar, 0x02.toChar,
      0x77.toChar, 0x0A.toChar, 0x78.toChar, 0x0A.toChar, 0x79.toChar, 0x0A.toChar, 0x7A.toChar, 0x0A.toChar, 0x02.toChar, 0x73.toChar, 0x0A.toChar, 0x74.toChar,
      0x0A.toChar, 0x75.toChar, 0x0A.toChar, 0x76.toChar, 0x0A.toChar, 0x02.toChar, 0x6E.toChar, 0x0A.toChar, 0x6F.toChar, 0x0A.toChar, 0x70.toChar, 0x0A.toChar,
      0x72.toChar, 0x0A.toChar, 0x02.toChar, 0x61.toChar, 0x0A.toChar, 0x65.toChar, 0x0A.toChar, 0x66.toChar, 0x0A.toChar, 0x6A.toChar, 0x0A.toChar, 0x02.toChar,
      0x5D.toChar, 0x0A.toChar, 0x5E.toChar, 0x0A.toChar, 0x5F.toChar, 0x0A.toChar, 0x60.toChar, 0x0A.toChar, 0x02.toChar, 0x57.toChar, 0x0A.toChar, 0x59.toChar,
      0x0A.toChar, 0x5A.toChar, 0x0A.toChar, 0x5B.toChar, 0x0A.toChar, 0x02.toChar, 0x4A.toChar, 0x0A.toChar, 0x4B.toChar, 0x0A.toChar, 0x4E.toChar, 0x0A.toChar,
      0x53.toChar, 0x0A.toChar, 0x02.toChar, 0x46.toChar, 0x0A.toChar, 0x47.toChar, 0x0A.toChar, 0x48.toChar, 0x0A.toChar, 0x49.toChar, 0x0A.toChar, 0x02.toChar,
      0x3F.toChar, 0x0A.toChar, 0x41.toChar, 0x0A.toChar, 0x42.toChar, 0x0A.toChar, 0x44.toChar, 0x0A.toChar, 0x02.toChar, 0x3A.toChar, 0x0A.toChar, 0x3C.toChar,
      0x0A.toChar, 0x3D.toChar, 0x0A.toChar, 0x3E.toChar, 0x0A.toChar, 0x02.toChar, 0x36.toChar, 0x0A.toChar, 0x37.toChar, 0x0A.toChar, 0x38.toChar, 0x0A.toChar,
      0x39.toChar, 0x0A.toChar, 0x02.toChar, 0x32.toChar, 0x0A.toChar, 0x33.toChar, 0x0A.toChar, 0x34.toChar, 0x0A.toChar, 0x35.toChar, 0x0A.toChar, 0x02.toChar,
      0x2B.toChar, 0x0A.toChar, 0x2C.toChar, 0x0A.toChar, 0x2D.toChar, 0x0A.toChar, 0x2E.toChar, 0x0A.toChar, 0x02.toChar, 0x26.toChar, 0x0A.toChar, 0x27.toChar,
      0x0A.toChar, 0x29.toChar, 0x0A.toChar, 0x2A.toChar, 0x0A.toChar, 0x02.toChar, 0x21.toChar, 0x0A.toChar, 0x22.toChar, 0x0A.toChar, 0x23.toChar, 0x0A.toChar,
      0x24.toChar, 0x0A.toChar, 0x03.toChar, 0xFB.toChar, 0x0B.toChar, 0xFC.toChar, 0x0B.toChar, 0xFD.toChar, 0x0B.toChar, 0xFE.toChar, 0x0B.toChar, 0x1B.toChar,
      0x0A.toChar, 0x1B.toChar, 0x0A.toChar, 0x1C.toChar, 0x0A.toChar, 0x1C.toChar, 0x0A.toChar, 0x03.toChar, 0xF2.toChar, 0x0B.toChar, 0xF3.toChar, 0x0B.toChar,
      0xF4.toChar, 0x0B.toChar, 0xF5.toChar, 0x0B.toChar, 0xF6.toChar, 0x0B.toChar, 0xF7.toChar, 0x0B.toChar, 0xF9.toChar, 0x0B.toChar, 0xFA.toChar, 0x0B.toChar,
      0x03.toChar, 0xE9.toChar, 0x0B.toChar, 0xEA.toChar, 0x0B.toChar, 0xEB.toChar, 0x0B.toChar, 0xEC.toChar, 0x0B.toChar, 0xED.toChar, 0x0B.toChar, 0xEE.toChar,
      0x0B.toChar, 0xEF.toChar, 0x0B.toChar, 0xF1.toChar, 0x0B.toChar, 0x03.toChar, 0xDE.toChar, 0x0B.toChar, 0xDF.toChar, 0x0B.toChar, 0xE1.toChar, 0x0B.toChar,
      0xE3.toChar, 0x0B.toChar, 0xE4.toChar, 0x0B.toChar, 0xE5.toChar, 0x0B.toChar, 0xE6.toChar, 0x0B.toChar, 0xE7.toChar, 0x0B.toChar, 0x03.toChar, 0xD6.toChar,
      0x0B.toChar, 0xD7.toChar, 0x0B.toChar, 0xD8.toChar, 0x0B.toChar, 0xD9.toChar, 0x0B.toChar, 0xDA.toChar, 0x0B.toChar, 0xDB.toChar, 0x0B.toChar, 0xDC.toChar,
      0x0B.toChar, 0xDD.toChar, 0x0B.toChar, 0x03.toChar, 0xCD.toChar, 0x0B.toChar, 0xCF.toChar, 0x0B.toChar, 0xD0.toChar, 0x0B.toChar, 0xD1.toChar, 0x0B.toChar,
      0xD2.toChar, 0x0B.toChar, 0xD3.toChar, 0x0B.toChar, 0xD4.toChar, 0x0B.toChar, 0xD5.toChar, 0x0B.toChar, 0x03.toChar, 0xC5.toChar, 0x0B.toChar, 0xC6.toChar,
      0x0B.toChar, 0xC7.toChar, 0x0B.toChar, 0xC8.toChar, 0x0B.toChar, 0xC9.toChar, 0x0B.toChar, 0xCA.toChar, 0x0B.toChar, 0xCB.toChar, 0x0B.toChar, 0xCC.toChar,
      0x0B.toChar, 0x03.toChar, 0xBB.toChar, 0x0B.toChar, 0xBC.toChar, 0x0B.toChar, 0xBD.toChar, 0x0B.toChar, 0xBE.toChar, 0x0B.toChar, 0xBF.toChar, 0x0B.toChar,
      0xC1.toChar, 0x0B.toChar, 0xC3.toChar, 0x0B.toChar, 0xC4.toChar, 0x0B.toChar, 0x03.toChar, 0xB2.toChar, 0x0B.toChar, 0xB3.toChar, 0x0B.toChar, 0xB4.toChar,
      0x0B.toChar, 0xB5.toChar, 0x0B.toChar, 0xB6.toChar, 0x0B.toChar, 0xB7.toChar, 0x0B.toChar, 0xB9.toChar, 0x0B.toChar, 0xBA.toChar, 0x0B.toChar, 0x03.toChar,
      0xA9.toChar, 0x0B.toChar, 0xAA.toChar, 0x0B.toChar, 0xAB.toChar, 0x0B.toChar, 0xAC.toChar, 0x0B.toChar, 0xAD.toChar, 0x0B.toChar, 0xAE.toChar, 0x0B.toChar,
      0xAF.toChar, 0x0B.toChar, 0xB1.toChar, 0x0B.toChar, 0x03.toChar, 0x9F.toChar, 0x0B.toChar, 0xA1.toChar, 0x0B.toChar, 0xA3.toChar, 0x0B.toChar, 0xA4.toChar,
      0x0B.toChar, 0xA5.toChar, 0x0B.toChar, 0xA6.toChar, 0x0B.toChar, 0xA7.toChar, 0x0B.toChar, 0xA8.toChar, 0x0B.toChar, 0x03.toChar, 0x92.toChar, 0x0B.toChar,
      0x94.toChar, 0x0B.toChar, 0x99.toChar, 0x0B.toChar, 0x9A.toChar, 0x0B.toChar, 0x9B.toChar, 0x0B.toChar, 0x9C.toChar, 0x0B.toChar, 0x9D.toChar, 0x0B.toChar,
      0x9E.toChar, 0x0B.toChar, 0x03.toChar, 0x86.toChar, 0x0B.toChar, 0x87.toChar, 0x0B.toChar, 0x88.toChar, 0x0B.toChar, 0x8B.toChar, 0x0B.toChar, 0x8C.toChar,
      0x0B.toChar, 0x8D.toChar, 0x0B.toChar, 0x8E.toChar, 0x0B.toChar, 0x91.toChar, 0x0B.toChar, 0x03.toChar, 0x2F.toChar, 0x0B.toChar, 0x4F.toChar, 0x0B.toChar,
      0x54.toChar, 0x0B.toChar, 0x5C.toChar, 0x0B.toChar, 0x71.toChar, 0x0B.toChar, 0x7B.toChar, 0x0B.toChar, 0x84.toChar, 0x0B.toChar, 0x85.toChar, 0x0B.toChar
    )

  val bitMasks: Array[Int] = Array(
    0x0000, 0x0001, 0x0003, 0x0007, 0x000F, 0x001F, 0x003F, 0x007F,
    0x00FF, 0x01FF, 0x03FF, 0x07FF, 0x0FFF, 0x1FFF, 0x3FFF, 0x7FFF
  )
}
